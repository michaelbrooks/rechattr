$def with (user, polls)
$var css: myevents.css
$var nav: $:elements.nav('myevents', user)
$ create_url = urls.new_poll()
<div class="row-fluid">
    <div class="span12">
        <h3>My Events <a href="$create_url" class="btn btn-success create-event-button pull-right">Create a new event</a></h3>
        <table class="poll-list table">
            <thead>
                <tr>
                    <th class="title-header">Title / Hashtag</th>
                    <th class="status-header">Status</th>
                    <th class="tweets-header">Tweets</th>
                    <th class="responses-header">Responses</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
            $for poll in polls:
                $ poll_edit_url = urls.poll_edit(poll)
                $ poll_results_url = urls.poll_results(poll)
                $ poll_start = user.from_localtime(poll.event_start)
                $ poll_stop = user.from_localtime(poll.event_stop)
                <tr class="poll-list-item">
                    <td class="poll-title">
                        $poll.title <span class="poll-hashtag muted">$poll.twitter_hashtag</span>
                    $if poll.is_active():
                        <span class="poll-timing-info">
                            Ends in $time_to(poll_stop, long=True, showDays=True)
                        </span>
                    $elif poll.has_started():
                        <span class="poll-timing-info">
                            Ended $time_ago(poll_stop, long=True, showDays=True) ago
                        </span>
                    $else:
                        <span class="poll-timing-info">
                            Starts in $time_to(poll_start, long=True, showDays=True)
                        </span>
                    </td>
                    <td class="poll-status">
                    $if poll.is_active():
                        <span class="poll-status-active label label-success">Live!</span>
                    $elif poll.has_started():
                        <span class="poll-status-ended label label-info">Ended</span>
                    $else:
                        <span class="poll-status-pending label">Not started</span>
                    </td>
                    <td class="tweet-count">
                        $poll.count_tweets()
                    </td>
                    <td class="response-count">
                        $poll.count_responses()
                    </td>
                    <td class="poll-controls">
                    $if poll.is_active():
                        <a class="btn btn-primary pull-right" href="$poll_results_url">Monitor Event</a>
                    $elif poll.has_started():
                        <a class="btn btn-primary pull-right" href="$poll_results_url">View Results</a>
                    $else:
                        <a class="btn pull-right" href="$poll_edit_url">Edit Event</a>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
